
steps:
- id: Clone Fluid-Slurm-GCP
  name: 'gcr.io/cloud-builders/gcloud'
  args: ["source", "repos", "clone", "terraform-fluidnumerics-slurm_gcp", "--project=managed-fluid-slurm-gcp"]

- id: Terraform plan and apply
  name: 'hashicorp/terraform:0.12.26'
  entrypoint: 'sh'
  args: 
  - '-c'
  - | 
      cd fluid-slurm-gcp/skus/minimal
      terraform init
      terraform validate || exit 1
      terraform plan || exit 1
      terraform apply -auto-approve

